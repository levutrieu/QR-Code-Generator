<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
	<title>Generate QR Code</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
	<script type="text/javascript" src="https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>


	<style>
		td {
			min-width: 100px;
		}
		input {
			width: 100%;
		}
	</style>
</head>
<body>
	<div style="display: flex; flex-direction: row; flex-wrap: wrap; align-content: flex-start;">
		<div style="width: 500px; margin-left: 5px; border: 0.5px solid black;">
			<table style="width: 80%; margin-left: auto; margin-right: auto;">
				<tr>
				  <td style="width: 120px;">
					  <label for="sizes">Kích thước:</label>
				  </td>
				  <td>
					  <select name="sizes" id="sizes" style="width: 120px;">
						<option value="50">50 x 50</option>
						<option value="100">100 x 100</option>
						<option value="200">200 x 200</option>
						<option value="300">300 x 300</option>
						<option value="500">500 x 500</option>
						<option value="1000">1000 x 1000</option>
					  </select>
				  </td>
				</tr>
				<tr>
				  <td>
					  <label for="types">Loại:</label>
				  </td>
				  <td>
					  <select name="types" id="types" style="width: 120px;">
						<option value="dots">dots</option>
						<option value="rounded">rounded</option>
						<option value="classy">classy</option>
						<option value="classy-rounded">classy-rounded</option>
						<option value="square">square</option>
						<option value="extra-rounded">extra-rounded</option>
					  </select>
				  </td>
				</tr>
				<tr>
				  <td>
					  <label for="colors">Màu:</label>
				  </td>
				  <td>
					  <input type="text" id="colors" name="colors" style="width: 112px;">
				  </td>
				</tr>
				<tr>
				  <td>
					  <label for="colors_b">Màu nền:</label>
				  </td>
				  <td>
					  <input type="text" id="colors_b" name="colors_b" style="width: 112px;">
				  </td>
				</tr>
				<tr>
				  <td style="vertical-align:top">
					  <label for="datas">Dữ liệu:</label>
				  </td>
				  <td>
					  <textarea type="text" id="datas" name="datas" cols="50" rows="10"></textarea>
				  </td>
				</tr>
				<tr>
				  <td style="vertical-align:top">
					  <label for="images">Link hình ảnh:</label>
				  </td>
				  <td>
					  <textarea type="text" id="images" name="images" cols="50" rows="5"></textarea>
				  </td>
				</tr>
				<tr>
				  <td>
					  <label for="i_size">Image size:</label>
				  </td>
				  <td>
					  <select name="i_size" id="i_size"  style="width: 120px;">
						  <option value="0.1">0.1</option>
						  <option value="0.2">0.2</option>
						  <option value="0.3">0.3</option>
						  <option value="0.4">0.4</option>
						  <option value="0.5">0.5</option>
						  <option value="0.6">0.6</option>
						  <option value="0.7">0.7</option>
						  <option value="0.8">0.8</option>
						  <option value="0.9">0.9</option>				
					  </select>
				  </td>
				</tr>
				<tr>
				  <td>
					  <label for="level">Sửa lỗi mã QR:</label>
				  </td>
				  <td>
					  <select name="level" id="level"  style="width: 120px;">
						  <option value="L">L (~7%)</option>
						  <option value="M">M (~15%)</option>
						  <option value="Q">Q (~25%)</option>
						  <option value="H">H (~30%)</option>		
					  </select>
				  </td>
				</tr>
				<tr>
				  <td></td>
				  <td>
					  <button type="button" id="run" style="width: 150px; height: 30px; cursor: pointer;">Tạo QR Code</button> 
					  <button type="button" id="save" style="width: 150px; height: 30px; cursor: pointer;">Lưu QR Code</button> 
					  <button type="button" id="export" style="width: 150px; height: 30px; cursor: pointer;">Export excel</button> 
				  </td>
				</tr>
			  </table>
		</div>


		<div style="width: 650px; margin-left: 5px; background-color: darkkhaki; border: 0.5px solid black;">
			<a href="https://github.com/abdulwakili/javascript-qrcode-generator-with-image"  target="_blank">Github</a>			
			<br>
			<a href="https://tools.completejavascript.com/vcard-qr-code-generator/"  target="_blank">Xem ví dụ nội dung truyền vào từng loại QR Code</a>
			<br>
			<br>
			<div style="text-align: center; font-weight: bold;">HƯỚNG DẪN NHẬP DỮ LIỆU QR CODE</div>
			<br>
			<div>- WIFI: <span style="color: green;">WIFI:S:DayLaTenWifi;T:WPA;P:DayLaPass;H:false;;</span></div>
			<div>&ensp;1. S => Tên wifi</div>
			<div>&ensp;2. T => Loại bảo mật</div>
			<div>&ensp;&ensp;* Loại NONE: nopass</div>
			<div>&ensp;&ensp;* Loại WPA/WPA2: WPA</div>
			<div>&ensp;&ensp;* Loại WEP: WEP</div>
			<div>&ensp;3. P => Mật khẩu</div>
			<div>&ensp;4. H => Loại Wifi Hidden Network (true | false)</div>
			<div>- EMAIL: <span style="color: green;">mailto:example@email.com?subject=Đây là tiêu đề&body=Đây là nội dung</span></div>
			<div>&ensp;1. mailto => Địa chỉ email nhận</div>
			<div>&ensp;2. subject => Tiêu đề email</div>
			<div>&ensp;3. body => Nội dung email</div>
			<div>&ensp;&ensp;* Tiêu đề và nội dung sẽ phải encode bằng hàm <i>encodeURIComponent('Đây là tiêu đề')</i></div>
			<div>&ensp;&ensp;&ensp;&ensp;hoặc dùng <a href="https://www.urlencoder.org/" target="_blank">tools</a></div>
			<div>- SMS:</div>
			<div>&ensp;1. Chỉ có số điện thoại => <span style="color: green;">SMSTO:1900:</span></div>
			<div>&ensp;2. Số điện thoại + nội dung tin nhắn => <span style="color: green;">SMSTO:1900:Chào, tôi là Triều Lê</span></div>
			<div>&ensp;3. Không có số điện thoại, chỉ có nội dung tin nhắn => <span style="color: green;">SMSTO::Chào, tôi là Triều Lê</span></div>
			<div>- PHONE: <span style="color: green;">tel:0983299443</span></div>
		</div>
	</div>
	<div id="qr_code" style="margin-left: 20px;"></div>

	<div id="grid" style="display: none;"></div>
	<table class="order-table table sortable" id="tableadmin" style="display: none; border: 0.5px solid black;">
		<thead>
			<tr>
				<th style="width:320px;">Image</th>
				<th>Text</th>
			</tr>
		</thead>
		<tbody id="changetable" class="new">
			<tr>
				<td>
					<div id="I1"></div>
					<img id="C1"></image>
				</td>
				<td>
				</td>
			</tr>
		</tbody>
	</table>

	

    <script type="text/javascript">
		var qrCode;
		document.getElementById("images").value = "https://avatars.githubusercontent.com/u/13997578?v=4";	
		document.getElementById("datas").value = "https://tlsoftware.xyz";
		document.getElementById("colors").value = "#12656bff";
		document.getElementById("colors_b").value = "#ffffff";
		document.getElementById("types").value = "rounded";
		document.getElementById("sizes").value = "200";
		document.getElementById("i_size").value = "0.5";
		document.getElementById("level").value = "H";

		$("#run").on( "click", function() {
			$("#qr_code").empty();
			var _size = document.getElementById("sizes").value;
			var _types = document.getElementById("types").value;
			var value = document.getElementById("sizes").value;
			var _width, _height;
			
			switch (_size) {
				case "50":
					_width = 50;
					_height = 50;
					break;
				case "100":
					_width = 100;
					_height = 100;
					break;
				case "200":
					_width = 200;
					_height = 200;
					break;
				case "300":
					_width = 300;
					_height = 300;
					break;
				case "500":
					_width = 500;
					_height = 500;
					break;
				case "1000":
					_width = 1000;
					_height = 1000;
					break;
				default:
					_width = 300;
					_height = 300;
					break;
			}
			
			var _value = document.getElementById("datas").value;
			//if(_value.substring(0, 6) == 'mailto'){
			//	_value = 
			//}

			qrCode = new QRCodeStyling({
                width: _width,
                height: _height,
                type: "canvas",
                data: document.getElementById("datas").value,
                image: href = document.getElementById("images").value,
				qrOptions: {
					errorCorrectionLevel: document.getElementById("level").value,
				},
                dotsOptions: {
                    color: document.getElementById("colors").value,
                    type: _types
                },
                backgroundOptions: {
                    color: document.getElementById("colors_b").value,
                },
                imageOptions: {
					imageSize: document.getElementById("i_size").value,
                    crossOrigin: undefined,
                    margin: 2,
                }
            });
            
			qrCode.append(document.getElementById("qr_code"));

            //qrCode.append(document.getElementById("I1"));	
			//var canvas = document.getElementById("I1").childNodes[0];
			//var context = canvas.getContext("2d");
			//var dataURL = canvas.toDataURL("image/png", 0.5);
			//console.log(canvas);
			//console.log(dataURL);
			//var img = document.getElementById("C1");
    		//img.src = dataURL;
		} );

		$("#save").on( "click", function() {
			if(qrCode){
				var _s = document.getElementById("sizes");
				var _s_text= _s.options[_s.selectedIndex].text;
				qrCode.download({ name: "qrcode_" + $("#datas").val() + '_' + _s_text, extension: "svg" });
			}
		} );
    </script>

</body>
</html>
